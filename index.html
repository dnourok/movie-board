<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>The Bucket List</title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>
  <h1> The Bucket List </h1>
    <div class="containerSearchMovie">
      <input id="movieSearch" type="text" />
      <button type="#button" class="btn btn-primary"><a id="button-text" href="#openModal">Search Movie</a></button>
    </div>
      
    <div id="openModal" class="modalDecoration">
      <div class="populateModal"> <a href="#close" title="Close" class="close">X</a>
        <h2 id="modalTitle">Add a Movie to Bucket List</h2>
          <div class="card">
          </div>
      </div>
    </div>

    <div class="container">
     <div class="row">
     </div>
    </div>

<!-- col-sm-3 is 4 cards per row
col-sm-4 is 3 cards per row
 -->
 
</body>

	
</body>
  <script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>
<script>
$(function() {
    var url = 'http://api.themoviedb.org/3/',
        mode = 'search/movie',
        input,
        movieName,
        key = '?api_key=c07bb825bc25d93f2608eb1883a674e4',
        urlPoster = 'http://api.themoviedb.org/3/configuration';
       

    $('button').click(function() {
        var input = $('#movieSearch').val(),
            movieName = encodeURI(input);
        $.ajax({
            url: url + mode + key + '&query='+movieName ,
            dataType: 'jsonp',
            success: function(data) {
             var information = data.results;
             console.log(data);
             var $card = $('.card');
             var $modal = $('.populateModal');
   						 $.each(information, function (i, item) {
                  var plot = item.overview;
                  var title = item.title;
                  var language = item.original_language;
                  var poster = item.poster_path;
                    
                    $('<div class="movieInfo">' + '<p class="title">' + "Title:  " + title + '</p>' + '<p>' + "Plot:  " + plot + '</p>' + '<p>' + "Original Language:  " + language + '</p>' + '<div class="plus-icon">' + '</figcaption><i class="glyphicon glyphicon-plus"></i>' + '</div>' + '</div>').prependTo($card).appendTo($modal);

    					});
    					
            }
        });
       
    });

  // clears movie cards once modal closes
    $('.close').click(function() {
      $('.movieInfo').empty();
    });

// Note: Click function only works for elements already on the page. Have to use
// .on for an element on the page and then after click call what has been created
// as a jquery element

  // changes class of movieInfo as not to delete all cards once modal is closed
  // and appends to the page the card you wish to add to your bucket list
    $('.populateModal').on('click','.plus-icon',function(e){
      e.preventDefault();
      var cardToAttach = $(this).closest($("[class^=movieInfo]"));
        $(cardToAttach).appendTo('.row').attr("class", "col-sm-3");
        // right here put a line to change plus icon to the trash
        // $('.modalDecoration').css('display','none');
}); 




    // $('.movieInfo').click(function() {
    //   console.log(working);
    // });


  // to get rid of the unwanted cards on the board just use the same function w/ the call on the trash icon

    // $('.plus-icon').click(function() {
    //   console.log(working);
    // });




// second AJAX call through a promise function?

// works in this scope
// var par = "words";
// var $test = $('.test');
// $('<p>' + par + '</p>').appendTo($test);

});

// Todo: prepend cards to Modal
// if click X then clears any cards appended
// maybe clears movieinfo and when it gets put to the page permanently then changes class
// pin or tack png
// add rows to normal page so you can align cards



</script>
</html>